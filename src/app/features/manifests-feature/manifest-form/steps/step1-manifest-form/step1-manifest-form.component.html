<div class="p-4">
  <h3 class="text-lg font-semibold pb-4">Selecciona fecha y sucursales</h3>

  <!-- Date selection -->
  <div class="pb-6 flex flex-col gap-2">
    <label class="text-sm font-medium text-gray-700">Fecha de Servicio</label>
    <p-calendar
      [(ngModel)]="selectedDate"
      [showIcon]="true"
      dateFormat="dd/mm/yy"
      placeholder="Select date"
      styleClass="w-full max-w-96"
    ></p-calendar>
    <small class="text-gray-500 mt-1 block"
      >Selecciona la fecha para buscar ventas pendientes</small
    >
  </div>

  <!-- Branch selection -->
  <div class="pb-6">
    <label class="text-sm font-medium text-gray-700 pb-2">Sucursales</label>
    <p-table
      [value]="branches()"
      [scrollHeight]="'280px'"
      styleClass="p-datatable-sm"
      [scrollable]="true"
      [selection]="selectedBranches()"
      (selectionChange)="onBranchSelectionChange($event)"
    >
      <ng-template pTemplate="header">
        <tr>
          <th style="width: 3rem">
            <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
          </th>
          <th>Descripción</th>
          <th>Dirección</th>
          <th></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-branch>
        <tr>
          <td>
            <p-tableCheckbox [value]="branch"></p-tableCheckbox>
          </td>
          <td>{{ branch.description }}</td>
          <td>{{ branch.address }}</td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="4" class="text-center">
            <div
              *ngIf="loadingBranches()"
              class="p-4 flex flex-col items-center"
            >
              <p-skeleton height="2rem" width="60%"></p-skeleton>
              <p-skeleton height="2rem" width="80%" class="mt-2"></p-skeleton>
              <p-skeleton height="2rem" width="70%" class="mt-2"></p-skeleton>
            </div>
            <div *ngIf="!loadingBranches()">No branches available</div>
          </td>
        </tr>
      </ng-template>
    </p-table>
    <small class="text-gray-500 mt-1 block"
      >Selecciona las sucursales en las que deseas buscar ventas</small
    >
  </div>

  <!-- Action buttons -->
  <div class="flex justify-end mt-4">
    <button
      pButton
    label="Buscar ventas pendientes"
      icon="pi pi-search"
      [loading]="loading()"
      [disabled]="!canAdvance"
      (click)="searchSales()"
      class="md:w-auto"
    ></button>
  </div>
</div>
