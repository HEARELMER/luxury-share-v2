<div class="bg-white rounded-lg border w-full">
 
  <div class="w-full pb-4 flex px-4 gap-2 items-center">
    <app-select class="w-full" label="Tipo" [options]="filterServiceByType" />
    <app-select
      class="w-full"
      label="Precio"
      [options]="filterServiceByPrice"
    />
    <app-select
      class="w-full"
      label="Estado"
      [options]="filterServiceByStatus"
    />
  </div>

  <p-table
    [columns]="cols"
    [value]="virtualServices()"
    [lazy]="true"
    [scrollable]="true"
    [virtualScroll]="true"
    [virtualScrollItemSize]="50"
    [loading]="loading"
    [totalRecords]="totalRecords"
    scrollHeight="400px"
    (onLazyLoad)="loadServices()"
    [resizableColumns]="true"
    styleClass="p-datatable-gridlines"
    [tableStyle]="{ 'min-width': '50rem' }"
    selectionMode="single"
    [(selection)]="selectedService"
    [metaKeySelection]="true"
    dataKey="serviceId"
  >
    <ng-template pTemplate="header" let-columns>
      <tr>
        @for (col of columns; track $index) {
        <th
          pResizableColumn
          class="text-primary-l-500 cursor-pointer border-y py-2 font-semibold border border-primary-100 bg-primary-l-100"
        >
          {{ col.header }}
        </th>

        }
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-service let-columns="columns">
      <tr [pSelectableRow]="service">
        @for (col of columns; track $index) {
        <td>
          @if (col.field == "status") { @if (service[col.field] === true ) {
          <p-tag severity="success" value="Activo"></p-tag>
          } @else if (service[col.field] === false) {
          <p-tag severity="info" value="Inactivo"></p-tag>
          } } @else if (col.field == "createdAt") {
          {{ service[col.field] | date : "dd/MM/yyyy hh:mm a" }}
          } @else if (col.field == "updatedAt") {
          {{ service[col.field] | date : "dd/MM/yyyy hh:mm a" }}
          } @else if (col.field=="actions") {
          <div class="flex gap-1">
            <button
              class="button-table-actions"
              [pTooltip]="'Editar Usuario'"
              tooltipPosition="left"
              [showDelay]="300"
            >
              <i class="pi pi-file-edit"></i>
            </button>
          </div>

          } @else {
          {{ service[col.field] }}

          }
        </td>
        }
      </tr>
    </ng-template>

    <ng-template pTemplate="loadingbody" let-columns="columns">
      <tr>
        @for (col of columns; track $index) {
        <td>
          <p-skeleton></p-skeleton>
        </td>

        }
      </tr>
    </ng-template>
  </p-table>
  <div class="card flex flex-col gap-4">
    <div class="flex items-center justify-center">
      <div class="flex-1">
        <p-paginator
          (onPageChange)="onPageChange($event)"
          [first]="first"
          [rows]="rows"
          [totalRecords]="totalRecords"
          [rowsPerPageOptions]="rowsPerPageOptions"
          [showFirstLastIcon]="false"
        />
      </div>
    </div>
  </div>
</div>
